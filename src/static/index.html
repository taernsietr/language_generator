<!DOCTYPE html>
<html>

    <head> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Language Generator</title>
        <style>

            * {
                font-family: "monospace";
            }

            body {
                display: flex;
                justify-content: center;
                flex-direction: column;
                background-color: black;
                color: #d50;
            }

            .bordered {
                border: 1px solid #d50;
                margin: 5px;
            }

            .flex-row {
                display: flex;
                flex-direction: row;
            }

            .flex-col {
                display: flex;
                flex-direction: column;
            }

            .wrap {
                flex-wrap: wrap
            }

            h3 {
                flex-basis: 100%;
            }

            .centered {
                justify-content: center;
            }

            .space-around {
                justify-content: space-around;
            }

            .menu-button {
                background-color: black;
                color: #d50;
                transition: 0.5s;
            }

            .menu-button:hover {
                background-color: #d50;
                color: black;
            }

            .hidden {
                display: none;
            }

            .centered-text {
                text-align: center;
            }

        </style>
    </head>

    <body>
        <!-- Menu, currently shows the options -->
        <div id="menu" class="bordered flex-row space-around">
            <div class="flex-col">
                <button class="menu-button bordered" type="submit" onclick="getRandom('word')">Random Word</button>
                <input type="range" min="1" max="10" value="4" id="wordLengthSlider" class="menu-button bordered"></button>
            </div>
            <div class="flex-col"><button class="menu-button bordered" type="submit" onclick="getRandom('text')">Random Text</button></div>
            <div class="flex-col"><button class="menu-button bordered" type="submit" onclick="saveSettings()">Save Settings</button></div>
            <div class="flex-col"><button class="menu-button bordered" type="submit" onclick="loadSettings()">Load Settings</button></div>
            <div class="flex-col"><button class="menu-button bordered" type="submit" onclick="toggleSettingsDisplay()">Toggle Settings</button></div>
        </div>

        <!-- Displays information about the generation settings -->
        <div id="settingsDisplay" class="flex-col space-around bordered">
        <div class="flex-row wrap centered">
            <h3 class="centered-text">Settings</h3>
            <div id="settingsContents"></div>
        </div>
        </div>

        <!-- Displays the results of generating words or text -->
        <div id="resultsDisplay" class="flex-row centered bordered">
            <p id="results" class="centered-text">Please select one of the options above!</p>
        </div>

        <script>

            let settingsDisplayState = false;

            function toggleSettingsDisplay() {
                settingsDisplayState = (settingsDisplayState) ? false : true;
                document.getElementById("settingsDisplay").className = (settingsDisplayState) ? "flex-row centered bordered" : "centered-container bordered hidden";
                console.log("settingsDisplayState: " + settingsDisplayState);
                console.log("settingsDisplay class:" + document.getElementById("settingsDisplay").className);
            }

            function getRandom(type) {
                let request = new XMLHttpRequest(); 
                request.onreadystatechange = displayResponse;
                request.open("GET", "/api/" + type);
                request.send();

                function displayResponse() {
                    if (request.readyState != 4) return;
                    document.getElementById("results").innerText = request.responseText;
                }
            };

            function loadSettings() {
                let request = new XMLHttpRequest();
                request.onreadystatechange = displayResponse;
                request.open("GET", "/api/current");
                request.send();

                function displayResponse() {
                    if (request.readyState != 4) return;
                    let data = JSON.parse(request.responseText);

                    let rows = "";
                    data["symbols"].forEach((symbol, index) => {
                        rows += "<tr><td>" + symbol + "</td><td>" + data["categories"][index] + "</td></tr>";
                    });

                    document.getElementById("settingsContents").innerHTML = 
                    "<table>" +
                    "<tr><th>Categories</th><th>Elements</th></tr>" + rows.replace(/,/g, " ");
                }
            }
            
        </script>
    </body>

</html>
